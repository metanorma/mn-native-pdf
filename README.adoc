= Metanorma Native PDF

image:https://github.com/metanorma/mn-native-pdf/workflows/ubuntu/badge.svg["Build Status", link="https://github.com/metanorma/mn-native-pdf/actions?workflow=ubuntu"]
image:https://github.com/metanorma/mn-native-pdf/workflows/macos/badge.svg["Build Status", link="https://github.com/metanorma/mn-native-pdf/actions?workflow=macos"]

The experimental PDFs are available here:

* https://metanorma.github.io/mn-native-pdf/[Metanorma mn2pdf samples]


== Purpose

This repository pilots native PDF capabilities of Metanorma using XML-FO via Apache FOP.


== Installing Build Tools

You will need `mn2pdf`, `envsubst`, `make` and a number of fonts.

=== On macOS

[source,sh]
----
# Install `envsubst`
brew install gettext
brew link --force gettext

# Install cabextract
brew install cabextract
----

[source,sh]
----
export MN_PDF_FONT_PATH=$(pwd)/.fonts

# Install Microsoft Vista fonts
export MS_FONT_PATH=${MN_PDF_FONT_PATH}/truetype/vista
export RENAME_FONTS=false
curl -Ls https://raw.githubusercontent.com/metanorma/vista-fonts-installer/master/vista-fonts-installer.sh | bash

# Install Microsoft Core fonts
mkdir -p ${MN_PDF_FONT_PATH}/truetype/msttcorefonts
ls -alR /System/Library/Fonts
ln -s /System/Library/Fonts/Supplemental/Arial.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/arial.ttf
ln -s /System/Library/Fonts/Supplemental/Arial\ Bold.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/arialbd.ttf
ln -s /System/Library/Fonts/Supplemental/Arial\ Italic.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/ariali.ttf
ln -s /System/Library/Fonts/Supplemental/Arial\ Bold\ Italic.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/arialbi.ttf
ln -s /System/Library/Fonts/Supplemental/Arial\ Black.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/ariblk.ttf
ln -s /System/Library/Fonts/Supplemental/Times\ New\ Roman.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/times.ttf
ln -s /System/Library/Fonts/Supplemental/Times\ New\ Roman\ Bold.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/timesbd.ttf
ln -s /System/Library/Fonts/Supplemental/Times\ New\ Roman\ Italic.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/timesi.ttf
ln -s /System/Library/Fonts/Supplemental/Times\ New\ Roman\ Bold\ Italic.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/timesbi.ttf
ln -s /System/Library/Fonts/Supplemental/Courier\ New.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/cour.ttf
ln -s /System/Library/Fonts/Supplemental/Courier\ New\ Italic.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/couri.ttf
ln -s /System/Library/Fonts/Supplemental/Courier\ New\ Bold.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/courbd.ttf
ln -s /System/Library/Fonts/Supplemental/Courier\ New\ Bold\ Italic.ttf ${MN_PDF_FONT_PATH}/truetype/msttcorefonts/courbi.ttf

ls -alR ${MN_PDF_FONT_PATH}
----

Generating XSLT layouts (will be created under `xslt/`):

[source,sh]
----
make xslts
----

Building the document is then easy:

[source,sh]
----

export MN_PDF_FONT_PATH=$(pwd)/.fonts
make all

# PDFs will be generated as documents/*.pdf
----

=== On Ubuntu Linux

[source,sh]
----
sudo apt-get -y install gettext-base cabextract wget

# Install fontforge
sudo apt-get -y install software-properties-common

# Install MS system fonts
echo ttf-mscorefonts-installer msttcorefonts/accepted-mscorefonts-eula select true | sudo debconf-set-selections
sudo apt-get install ttf-mscorefonts-installer

# Setup Cambria fonts
curl -Ls https://raw.githubusercontent.com/metanorma/vista-fonts-installer/master/vista-fonts-installer.sh | sudo bash
----


Generating XSLT layouts (will be created under `xslt/`):

[source,sh]
----
make xslts
----


Building the document is then easy:

[source,sh]
----
export MN_PDF_FONT_PATH=/usr/share/fonts

# Pull submodules
make update-init update-modules

# PDFs will be generated as documents/*.pdf
make all
----


== Copyright

Ribose Inc.
